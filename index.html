<html>
<head>
  <meta http-equiv="refresh" content="100000; url=https://mxo333.github.io/index.html">
    <style>
        /* CSS code goes here */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        .header {
            background-color: #333;
            color: white;
            padding: 20px;
            text-align: center;
        }

        .logo {
            font-size: 36px;
            font-weight: bold;
        }

        .nav {
            list-style: none;
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 10px;
            background-color: #eee;
        }

        .nav li {
            margin: 10px;
        }

        .nav a {
            text-decoration: none;
            color: #333;
        }

        .nav a:hover {
            color: #999;
        }

        .main {
            padding: 20px;
        }

        .post {
            margin-bottom: 40px;
        }

        .post-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .post-meta {
            color: #999;
            font-size: 14px;
            margin-bottom: 20px;
        }

        .post-content {
            line-height: 1.5;
        }

        .footer {
            background-color: #333;
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        pre {
            white-space: pre-wrap;
            font-family: monospace;
            background-color: #f4f4f4;
            padding: 10px;
            border-radius: 5px;
        }
        
        code {
            color: #333;
        }
        
        code .keyword {
            color: #0077aa;
        }
        
        code .string {
            color: #dd1144;
        }
        
        code .comment {
            color: #999988;
            font-style: italic;
        }
        
    </style>
</head>
<body>
    <div class="container">
        <div class="main"> 
                <div class="post">
                    <h2 class="post-title">tinygrad day 1: function approximation</h2>
                    <div class="post-meta">2023-07-11</div>
                    <div class="post-content">
                        You need to code your own MSE loss. Overall, it works like a charm, just like Pytorch.
                        Due to very little overhead in documentation, you will need trial and error to run the
                        moving codebase. Once understood however, it just works. Function approximation is solved.
                        PDE solving comes next.

                    <!---
                    <code>
                      class Net:
                          def __init__(self, in_channels=1, out_channels=1, num_layers=4, dims=6):
                              self.in_channels  = in_channels
                              self.out_channels = out_channels
                              self.num_layers   = num_layers
                              self.dims         = dims
                      
                              self.input_layer  = Linear(in_channels, dims)
                              self.output_layer = Linear(dims, out_channels)
                      
                              self.activation   = Tensor.tanh
                              self.layers       = [Linear(dims, dims, bias=False,) for _ in range(self.num_layers)]
                      
                      
                          def __call__(self, x: Tensor, transform = None):
                              if transform is None:
                                  return self.forward(x)
                              raise NotImplementedError("Transform case not handled yet")
                      
                          def forward(self, x):
                              x = self.activation(self.input_layer(x))
                              for l in self.layers:
                                  x = self.activation(l(x))
                              return self.output_layer(x)
                      
                      
                      def exact_solution(x: Tensor):
                          return Tensor.sin(x)
                      
                      # simple MSE
                      def loss_fn(x, y):
                          return ((x-y) ** 2).mean()
                      
                      
                      
                      if __name__ == '__main__':
                          Tensor.manual_seed(42)
                          net = Net()
                          n = 100
                          # samples
                          x = Tensor.uniform(n, 1) * pi
                          y = exact_solution(x)
                          optimizer = optim.Adam(get_parameters(net), lr=7e-4, b1=.9, b2=.98)
                          losses = list()
                          lossfn = loss_fn
                      
                          epochs = 1500
                          Tensor.training = True
                      
                          for step in range(epochs):
                              l = []
                              y_hat = net(x)
                              loss = lossfn(y_hat, y)
                              optimizer.zero_grad()
                              loss.backward()
                              optimizer.step()
                              losses.append(loss.detach().cpu().numpy())
                              print(f"{step=}: loss={losses[-1]:.2f}")
                    </code>
                    --->
                    </div>
                </div>

                <div class="post">
                    <h2 class="post-title">Notes on setting up tinygrad</h2>
                    <div class="post-meta">2023-07-08</div>
                    <div class="post-content">
                        micromamba create -n tiny pytorch numpy
                    </div>
                </div>

                <div class="post">
                    <h2 class="post-title">gm</h2>
                    <div class="post-meta">2023-07-06</div>
                    <div class="post-content">
                        Thoughts on technology and things I deem useful will appear here.
                    </div>
                </div>
        </div>
    </div>
</body>

